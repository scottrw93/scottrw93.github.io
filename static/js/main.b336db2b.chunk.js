(this["webpackJsonphome-wall"]=this["webpackJsonphome-wall"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(0),a=n.n(o),c=n(10),i=n.n(c),l=(n(97),n(24)),s=(n(98),n(42)),d=n(61),u=n(33),h=n(34),b=n(19),j=n(37),f=n(36),m="https://europe-west3-homewall-301021.cloudfunctions.net/HomeWall",p=n(153),x=n(139),g=n.p+"static/media/wall.ecca603c.jpg",O=function(e,t){return e.x===t.x&&e.y===t.y},v=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!O(e[n],t[n]))return!1;return!0},y=window.matchMedia&&window.matchMedia("screen and (max-width: 900px)").matches?2*window.devicePixelRatio:window.devicePixelRatio,w=window.matchMedia?window.matchMedia("screen and (max-width: 600px)").matches?2.1:window.matchMedia("screen and (max-width: 900px)").matches?1.5:1:1,C=function(e){return e/w*y},k=function(e,t){e.forEach((function(e){t.beginPath();var n=e[0],r=n.x,o=n.y;t.moveTo(C(r),C(o)),e.forEach((function(e){var n=e.x,r=e.y;return t.lineTo(C(n),C(r))})),t.lineTo(C(r),C(o)),t.stroke(),t.closePath()}))},P=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).canvasRef=a.a.createRef(),r.state={img:new Image},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.state.img,t=this.props.holds,n=this.canvasRef.current,r=n.getContext("2d");e.src=g,this.setState({img:e}),e.onload=function(){var o=Math.floor(e.height/(e.width/600)/w),a=Math.floor(600/w);n.width=a*y,n.height=o*y,n.style.width="".concat(a,"px"),n.style.height="".concat(o,"px"),r.drawImage(e,0,0,n.width,n.height),r.lineWidth=1*y,r.strokeStyle="#FFFFFF",k(t,r)}}},{key:"componentDidUpdate",value:function(e){var t=this.props.holds,n=e.holds,r=this.state.img;if(n!==t){var o=this.canvasRef.current,a=o.getContext("2d");!function(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(!v(e[n],t[n]))return!1;return!0}(t,n)?(a.clearRect(0,0,o.width,o.height),a.drawImage(r,0,0,o.width,o.height),k(t,a)):k(t.slice(n.length),a)}}},{key:"render",value:function(){var e=this,t=this.props.onClick;return Object(r.jsx)("canvas",{ref:this.canvasRef,onMouseDown:function(n){var r=n.clientX,o=n.clientY;if(t){var a=e.canvasRef.current.getBoundingClientRect(),c=r-a.left,i=o-a.top;t({x:c*w,y:i*w})}}})}}]),n}(a.a.PureComponent),N=n(145),S=n(159),H=n(144),I=n(161),L=n(156),B=n(162),M={0:"5",1:"5+",2:"6A",3:"6A+",4:"6B",5:"6B+",6:"6C",7:"6C+",8:"7A",9:"7A+",10:"7B"},R=function(e){return M[e]||e},T=a.a.createContext({}),W=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),E=function(e){var t=e.selectedHolds,n=e.clickHold,c=e.saveProblem,i=e.cancel,s=W(),d=a.a.useState(5),u=Object(l.a)(d,2),h=u[0],b=u[1],j=a.a.useState(null),f=Object(l.a)(j,2),m=f[0],p=f[1],x=Object(o.useContext)(T),g=t.length<3||!m||!h;return Object(r.jsxs)("div",{className:s.root,children:[Object(r.jsx)(P,{onClick:n,holds:t}),Object(r.jsxs)("div",{children:[Object(r.jsx)(S.a,{className:s.formControl,label:"Problem Name",variant:"outlined",onChange:function(e){var t=e.target.value;return p(t)}}),Object(r.jsxs)(H.a,{variant:"outlined",className:s.formControl,children:[Object(r.jsx)(I.a,{children:"Grade"}),Object(r.jsx)(L.a,{value:h,onChange:function(e){var t=e.target.value;return b(t)},label:"Grade",children:Object.keys(M).map((function(e){return Object(r.jsx)(B.a,{value:e,children:R(e)})}))})]})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)(N.a,{className:s.formControl,variant:"contained",color:"primary",onClick:function(){return c({name:m,grade:h,author:x.name,holds:t})},disabled:g,children:"Save problem"}),Object(r.jsx)(N.a,{className:s.formControl,variant:"contained",color:"secondary",onClick:i,children:"Cancel"})]})]})},G=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={selectedHolds:[]},r.clickHold=r.clickHold.bind(Object(b.a)(r)),r.saveProblem=r.saveProblem.bind(Object(b.a)(r)),r}return Object(h.a)(n,[{key:"clickHold",value:function(e){var t=this,n=e.x,r=e.y,o=this.props.holds,a=this.state.selectedHolds;o.forEach((function(e){(function(e,t){for(var n=e.x,r=e.y,o=!1,a=0,c=t.length-1;a<t.length;c=a++){var i=t[a].x,l=t[a].y,s=t[c].x,d=t[c].y;l>r!==d>r&&n<(s-i)*(r-l)/(d-l)+i&&(o=!o)}return o})({x:n,y:r},e)&&t.setState({selectedHolds:-1===a.indexOf(e)?[].concat(Object(d.a)(a),[e]):a.filter((function(t){return!v(t,e)}))})}))}},{key:"saveProblem",value:function(e){(0,this.props.createProblem)(e),this.setState({selectedHolds:[]})}},{key:"render",value:function(){var e=this.state.selectedHolds;return Object(r.jsx)(E,Object(s.a)(Object(s.a)({},this.props),{},{selectedHolds:e,clickHold:this.clickHold,saveProblem:this.saveProblem}))}}]),n}(a.a.PureComponent),F=n(152),D=n(154),A=n(146),J=n(74),z=n.n(J),U=Object(x.a)((function(e){return{appBar:{top:"auto",bottom:0,left:"auto",right:0,position:"fixed",width:"100%",display:"flex",zIndex:1100,boxSizing:"border-box",flexShrink:0,flexDirection:"column"},grow:{flexGrow:1},fabButton:{zIndex:1,top:-15,left:0,right:0,margin:"0 auto"}}})),q=function(e){var t=e.onCreate,n=U();return Object(r.jsx)("div",{color:"primary",className:n.appBar,children:Object(r.jsx)(A.a,{color:"secondary","aria-label":"add",className:n.fabButton,onClick:t,children:Object(r.jsx)(z.a,{})})})},X=n(147),Y=n(148),_=n(150),K=n(149),Q=n(75),V=n.n(Q),Z=n(66),$="read",ee="create",te="delete",ne="delete_own",re="990779024896-jr76oa2j7pj1116qhaa1qnu9offtp4ao.apps.googleusercontent.com",oe=function(e){var t=e.onLoginChange;return Object(o.useContext)(T).signedIn?Object(r.jsx)(Z.GoogleLogout,{clientId:re,buttonText:"Logout",onLogoutSuccess:function(){return t({signedIn:!1,scopes:[$]})}}):Object(r.jsx)(Z.GoogleLogin,{clientId:re,buttonText:"Login",onSuccess:function(e){var n=e.getBasicProfile();t({signedIn:!0,name:n.getName(),email:n.getEmail(),image:n.getImageUrl(),scopes:"Scott Williams"===n.getName()?[$,ee,te,ne]:[$,ee,ne]})},onFailure:function(){return null},isSignedIn:!0})},ae=Object(x.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},spacer:{width:"100%",height:"95px"}}})),ce=function(e){var t=e.onLoginChange,n=ae();return Object(r.jsxs)("div",{className:n.root,children:[Object(r.jsx)(X.a,{position:"fixed",children:Object(r.jsxs)(Y.a,{children:[Object(r.jsx)(K.a,{edge:"start",className:n.menuButton,color:"inherit","aria-label":"menu",children:Object(r.jsx)(V.a,{})}),Object(r.jsx)(_.a,{variant:"h6",className:n.title,children:"Home Wall"}),Object(r.jsx)(oe,{onLoginChange:t})]})}),Object(r.jsx)("div",{className:n.spacer})]})},ie=n(77),le=n.n(ie),se=n(76),de=n.n(se),ue=n(151),he=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},actions:{backgroundColor:e.palette.background.paper,"& svg":{margin:e.spacing(1.5)},"& svg:hover":{cursor:"pointer"},"& hr":{margin:e.spacing(0,.5)}},header:{paddingBottom:5}}})),be=function(e){var t=e.name,n=e.grade,o=e.author,a=e.cancel,c=he();return Object(r.jsx)("div",{className:c.header,children:Object(r.jsxs)(ue.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",children:[Object(r.jsxs)(ue.a,{item:!0,children:[Object(r.jsx)(_.a,{variant:"h5",component:"h2",children:"".concat(t," ").concat(R(n))}),Object(r.jsx)(_.a,{color:"textSecondary",children:"by ".concat(o)})]}),Object(r.jsx)(ue.a,{item:!0,children:Object(r.jsx)(K.a,{"aria-label":"back",onClick:a,children:Object(r.jsx)(de.a,{})})})]})})},je=function(e,t){return e.scopes.indexOf(te)>-1||e.scopes.indexOf(ne)>-1&&e.name===t},fe=function(e){var t=e.problem,n=t.author,a=t.holds,c=t.uuid,i=t.name,l=t.grade,s=e.deleteProblem,d=e.cancel,u=he(),h=Object(o.useContext)(T);return Object(r.jsx)("div",{className:u.root,children:Object(r.jsxs)("div",{children:[Object(r.jsx)(be,{name:i,grade:l,author:n,cancel:d}),Object(r.jsx)(P,{holds:a}),je(h,n)&&Object(r.jsx)(ue.a,{container:!0,alignItems:"center",direction:"row",justify:"flex-end",className:u.actions,children:Object(r.jsx)(le.a,{"aria-label":"delete",onClick:function(){s(c),d()}})})]})})},me=n(157),pe=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},card:{position:"relative",marginBottom:"50px",display:"inline-block",backgroundColor:"black","& div:hover":{cursor:"pointer"}},overlay:{position:"absolute",bottom:"0",left:"0",width:"100%",color:"white",backgroundColor:"black",opacity:.6},description:{padding:"10px 20px 10px 20px"}}})),xe=function(e){var t=e.problems,n=e.openProblem,o=e.filters,a=void 0===o?{name:null,grade:null,author:null}:o,c=pe();return 0===t.length?Object(r.jsx)("div",{className:c.root,children:"No problems created yet"}):Object(r.jsx)("div",{className:c.root,children:t.filter((function(e){var t=e.name;return!a.name||t.toLowerCase().indexOf(a.name.toLowerCase())>-1})).filter((function(e){var t=e.author;return!a.author||t.toLowerCase().indexOf(a.author.toLowerCase())>-1})).filter((function(e){var t=e.grade;return!a.grade||t<=a.grade.lte&&t>=a.grade.gte})).map((function(e){var t=e.uuid,o=e.holds,a=e.name,i=e.grade,l=e.author;return Object(r.jsx)("div",{className:c.card,onClick:function(){return n(t)},children:Object(r.jsxs)("div",{children:[Object(r.jsx)(P,{holds:o}),Object(r.jsx)("div",{className:c.overlay,children:Object(r.jsx)("div",{className:c.description,children:Object(r.jsx)(me.a,{display:"flex",p:1,children:Object(r.jsxs)(me.a,{p:1,flexGrow:1,children:[Object(r.jsx)(_.a,{variant:"h5",children:"".concat(a," ").concat(R(i))}),Object(r.jsx)(_.a,{variant:"body1",children:"by: ".concat(l)})]})})})})]})},a)}))})},ge=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},toolbar:e.mixins.toolbar,content:{flexGrow:1},loading:{display:"flex",justifyContent:"center",backgroundColor:e.palette.background.paper,marginTop:"50%",marginBottom:"50%"}}})),Oe=function(){var e=ge();return Object(r.jsx)("div",{className:e.loading,children:Object(r.jsx)(F.a,{})})},ve=function(e){var t=e.holds,n=e.page,c=e.problems,i=e.createProblem,s=e.deleteProblem,d=e.setPage,u=a.a.useState(null),h=Object(l.a)(u,2),b=h[0],j=h[1],f=Object(o.useContext)(T);return"problem"===n?Object(r.jsx)(fe,{problem:c.filter((function(e){return e.uuid===b}))[0],deleteProblem:s,cancel:function(){return d("list")}}):"create"===n?Object(r.jsx)(G,{holds:t,createProblem:function(e){return i(e)&&d("list")},cancel:function(){return d("list")}}):Object(r.jsxs)(a.a.Fragment,{children:[Object(r.jsx)(xe,{problems:c,openProblem:function(e){j(e),d("problem")}}),f.scopes.indexOf(ee)>-1&&Object(r.jsx)(q,{showCreate:"list"===n,onCreate:function(){return d("create")}})]})},ye=function(e){var t=e.problems,n=e.holds,o=e.createProblem,c=e.deleteProblem,i=e.loading,s=e.onLoginChange,d=(e.updateHolds,ge()),u=a.a.useState("list"),h=Object(l.a)(u,2),b=h[0],j=h[1];return Object(r.jsxs)("div",{className:d.root,children:[Object(r.jsx)(p.a,{}),Object(r.jsxs)("main",{className:d.content,children:[Object(r.jsx)(ce,{onLoginChange:s}),Object(r.jsx)(D.a,{maxWidth:"sm",children:i?Object(r.jsx)(Oe,{}):Object(r.jsx)(ve,{holds:n,page:b,problems:t,createProblem:o,deleteProblem:c,setPage:j})})]})]})},we=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={loading:!0,holds:[],problems:[]},r.updateHolds=r.updateHolds.bind(Object(b.a)(r)),r.createProblem=r.createProblem.bind(Object(b.a)(r)),r.deleteProblem=r.deleteProblem.bind(Object(b.a)(r)),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;return fetch("".concat(m,"/problems")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(t){return fetch("".concat(m,"/holds")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(n){return e.setState({problems:t,holds:n,loading:!1})}))}))}},{key:"createProblem",value:function(e){var t=this;return function(e){return fetch("".concat(m,"/problems"),{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(e){return t.setState({problems:[e].concat(Object(d.a)(t.state.problems))})}))}},{key:"deleteProblem",value:function(e){var t=this,n=this.state.problems;return function(e){return fetch("".concat(m,"/problems/").concat(e),{method:"DELETE"}).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(){return t.setState({problems:n.filter((function(t){return t.uuid!==e}))})}))}},{key:"updateHolds",value:function(e){var t=this;return function(e){return fetch("".concat(m,"/holds"),{method:"PUT",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(e){return t.setState({holds:e})}))}},{key:"render",value:function(){return Object(r.jsx)(ye,Object(s.a)(Object(s.a)({},this.props),{},{problems:this.state.problems,holds:this.state.holds,createProblem:this.createProblem,deleteProblem:this.deleteProblem,updateHolds:this.updateHolds,loading:this.state.loading}))}}]),n}(a.a.PureComponent),Ce=n(80),ke=n(155),Pe=n(78),Ne=n.n(Pe),Se=n(79),He=n.n(Se),Ie=Object(Ce.a)({palette:{primary:Ne.a,secondary:He.a}}),Le=function(){var e=a.a.useState({signedIn:!1,scopes:[$]}),t=Object(l.a)(e,2),n=t[0],o=t[1];return Object(r.jsx)(T.Provider,{value:n,children:Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(ke.a,{theme:Ie,children:Object(r.jsx)(we,{onLoginChange:o})})})})};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(Le,{})}),document.getElementById("root"))},97:function(e,t,n){},98:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.b336db2b.chunk.js.map