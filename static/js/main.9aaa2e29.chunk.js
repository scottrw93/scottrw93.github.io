(this["webpackJsonphome-wall"]=this["webpackJsonphome-wall"]||[]).push([[0],{107:function(e,t,n){},108:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),o=n.n(a),c=n(10),i=n.n(c),l=(n(107),n(19)),s=(n(108),n(43)),d=n(68),u=n(39),b=n(40),j=n(31),h=n(42),m=n(41),f="https://europe-west3-homewall-301021.cloudfunctions.net/HomeWall",p=n(172),x=n(154),O=n(171),g=n(173),v=n(59),w=n(162),y=n(163),C=n(69),k=n(158),P=n(85),N=n.n(P),S=n(76),L="read",I="create",B="delete",H="delete_own",R=o.a.createContext({}),W=n(178),M=n(156),T=n(66),E=n.n(T),F="990779024896-jr76oa2j7pj1116qhaa1qnu9offtp4ao.apps.googleusercontent.com",G=Object(x.a)((function(e){return{root:{position:"absolute",width:"100%",maxWidth:"650px",paddingLeft:10,paddingRight:10,left:"50%",transform:"translate(-50%, 0%)"}}})),A=function(e){var t=e.open,n=e.close,a=G();return Object(r.jsx)(M.a,{className:a.root,in:t,children:Object(r.jsx)(W.a,{severity:"error",action:Object(r.jsx)(k.a,{"aria-label":"close",color:"inherit",size:"small",onClick:n,children:Object(r.jsx)(E.a,{fontSize:"inherit"})}),children:"Failed to login"})})},D=function(e){var t=e.onLoginChange,n=Object(a.useContext)(R),c=o.a.useState(!1),i=Object(l.a)(c,2),s=i[0],d=i[1];return n.signedIn?Object(r.jsx)(S.GoogleLogout,{clientId:F,buttonText:"Logout",onLogoutSuccess:function(){return t({signedIn:!1,scopes:[L]})}}):Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(A,{open:s,close:function(){return d(!1)}}),Object(r.jsx)(S.GoogleLogin,{clientId:F,buttonText:"Login",onSuccess:function(e){var n=e.getBasicProfile();t({signedIn:!0,name:n.getName(),email:n.getEmail(),image:n.getImageUrl(),scopes:"Scott Williams"===n.getName()?[L,I,B,H]:[L,I,H]})},onFailure:function(){return d(!0)},isSignedIn:!0})]})},z=n(179),J=n(159),U=n(161),q=n(118),K=n(160),X=Object(x.a)({list:{width:250}}),Y=function(e){var t=e.walls,n=e.open,a=e.close,o=X(),c=function(){return function(e){("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&a()}};return Object(r.jsx)("div",{children:Object(r.jsx)(z.a,{anchor:"left",open:n,onClose:a,children:Object(r.jsx)("div",{className:o.list,role:"presentation",onClick:c,onKeyDown:c,children:Object(r.jsxs)(J.a,{children:[Object(r.jsx)(q.a,{button:!0,children:Object(r.jsx)(K.a,{primary:"Julia's wall"})}),t.map((function(e){var t=e.name;return Object(r.jsx)(q.a,{button:!0,children:Object(r.jsx)(K.a,{primary:t})},t)})),Object(r.jsx)(U.a,{}),Object(r.jsx)(q.a,{button:!0,children:Object(r.jsx)(K.a,{primary:"Add wall"})}),Object(r.jsx)(U.a,{}),Object(r.jsx)(q.a,{button:!0,children:Object(r.jsx)(K.a,{primary:"About"})})]})})})})},_=Object(x.a)((function(e){return{root:{flexGrow:1},narrow:Object(v.a)({},e.breakpoints.up("sm"),{width:"calc(100% - 250px)"}),menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},spacer:{width:"100%",height:"95px"}}})),Q=function(e){var t=e.walls,n=e.onLoginChange,a=_(),c=o.a.useState(!1),i=Object(l.a)(c,2),s=i[0],d=i[1];return Object(r.jsxs)("div",{className:a.root,children:[Object(r.jsx)(w.a,{className:s&&a.narrow,position:"fixed",children:Object(r.jsxs)(y.a,{children:[Object(r.jsx)(k.a,{edge:"start",className:a.menuButton,color:"inherit","aria-label":"menu",onClick:function(){return d(!0)},children:Object(r.jsx)(N.a,{})}),Object(r.jsx)(C.a,{variant:"h6",className:a.title,children:"Home Wall"}),Object(r.jsx)(D,{onLoginChange:n})]})}),Object(r.jsx)("div",{className:a.spacer}),Object(r.jsx)(Y,{walls:t,open:s,close:function(){return d(!1)}})]})},V=function(e,t){return e.x===t.x&&e.y===t.y},Z=function(e,t){if(e.points.length!==t.points.length)return!1;for(var n=0;n<e.points.length;n++)if(!V(e.points[n],t.points[n]))return!1;return!0},$="https://storage.googleapis.com/home-wall-images/wall.jpg",ee=window.matchMedia&&window.matchMedia("screen and (max-width: 900px)").matches?2*window.devicePixelRatio:window.devicePixelRatio,te=window.matchMedia?window.matchMedia("screen and (max-width: 600px)").matches?2.1:window.matchMedia("screen and (max-width: 900px)").matches?1.5:1:1,ne=function(e){return e/te*ee},re=function(e,t){e.forEach((function(e){var n=e.points;t.beginPath();var r=n[0],a=r.x,o=r.y;t.moveTo(ne(a),ne(o)),n.forEach((function(e){var n=e.x,r=e.y;return t.lineTo(ne(n),ne(r))})),t.lineTo(ne(a),ne(o)),t.stroke(),t.closePath()}))},ae=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).canvasRef=o.a.createRef(),r.state={img:null},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.holds,n=this.canvasRef.current,r=n.getContext("2d"),a=new Image;a.src=$,a.onload=function(){var o=Math.floor(a.height/(a.width/600)/te),c=Math.floor(600/te);n.width=c*ee,n.height=o*ee,n.style.width="".concat(c,"px"),n.style.height="".concat(o,"px"),r.drawImage(a,0,0,n.width,n.height),r.lineWidth=1*ee,r.strokeStyle="#FFFFFF",re(t,r),e.setState({img:a})}}},{key:"componentDidUpdate",value:function(e){var t=this.props.holds,n=e.holds,r=this.state.img;if(n!==t){var a=this.canvasRef.current,o=a.getContext("2d");!function(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(!Z(e[n],t[n]))return!1;return!0}(t,n)?(o.clearRect(0,0,a.width,a.height),o.drawImage(r,0,0,a.width,a.height),re(t,o)):re(t.slice(n.length),o)}}},{key:"render",value:function(){var e=this,t=this.props.onClick,n=this.state.img;return Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)("img",{alt:"board",style:n?{display:"none"}:{},width:600/te,height:"auto",src:$}),Object(r.jsx)("canvas",{style:n?{}:{display:"none"},ref:this.canvasRef,onMouseDown:function(n){var r=n.clientX,a=n.clientY;if(t){var o=e.canvasRef.current.getBoundingClientRect(),c=r-o.left,i=a-o.top;t({x:c*te,y:i*te})}}})]})}}]),n}(o.a.PureComponent),oe=n(168),ce=n(181),ie=n(166),le=n(183),se=n(176),de=n(167),ue={0:"5",1:"5+",2:"6A",3:"6A+",4:"6B",5:"6B+",6:"6C",7:"6C+",8:"7A",9:"7A+",10:"7B"},be=function(e){return ue[e]||e},je=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),he=function(e){var t=e.selectedHolds,n=e.clickHold,c=e.saveProblem,i=e.cancel,s=je(),d=o.a.useState(5),u=Object(l.a)(d,2),b=u[0],j=u[1],h=o.a.useState(null),m=Object(l.a)(h,2),f=m[0],p=m[1],x=Object(a.useContext)(R),O=t.length<3||!f||!b;return Object(r.jsxs)("div",{className:s.root,children:[Object(r.jsx)(ae,{onClick:n,holds:t}),Object(r.jsxs)("div",{children:[Object(r.jsx)(ce.a,{className:s.formControl,label:"Problem Name",variant:"outlined",onChange:function(e){var t=e.target.value;return p(t)}}),Object(r.jsxs)(ie.a,{variant:"outlined",className:s.formControl,children:[Object(r.jsx)(le.a,{children:"Grade"}),Object(r.jsx)(se.a,{value:b,onChange:function(e){var t=e.target.value;return j(t)},label:"Grade",children:Object.keys(ue).map((function(e){return Object(r.jsx)(de.a,{value:e,children:be(e)},e)}))})]})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)(oe.a,{className:s.formControl,variant:"contained",color:"primary",onClick:function(){return c({name:f,grade:b,author:x.name,holds:t,wallUuid:"813d0573-9640-4643-94d5-ecf3d512db4e"})},disabled:O,children:"Save problem"}),Object(r.jsx)(oe.a,{className:s.formControl,variant:"contained",color:"secondary",onClick:i,children:"Cancel"})]})]})},me=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={selectedHolds:[]},r.clickHold=r.clickHold.bind(Object(j.a)(r)),r.saveProblem=r.saveProblem.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"clickHold",value:function(e){var t=this,n=e.x,r=e.y,a=this.props.holds,o=this.state.selectedHolds;a.forEach((function(e){(function(e,t){for(var n=e.x,r=e.y,a=!1,o=0,c=t.length-1;o<t.length;c=o++){var i=t[o].x,l=t[o].y,s=t[c].x,d=t[c].y;l>r!==d>r&&n<(s-i)*(r-l)/(d-l)+i&&(a=!a)}return a})({x:n,y:r},e.points)&&t.setState({selectedHolds:-1===o.indexOf(e)?[].concat(Object(d.a)(o),[e]):o.filter((function(t){return!Z(t,e)}))})}))}},{key:"saveProblem",value:function(e){(0,this.props.createProblem)(e),this.setState({selectedHolds:[]})}},{key:"render",value:function(){var e=this.state.selectedHolds;return Object(r.jsx)(he,Object(s.a)(Object(s.a)({},this.props),{},{selectedHolds:e,clickHold:this.clickHold,saveProblem:this.saveProblem}))}}]),n}(o.a.PureComponent),fe=n(86),pe=n.n(fe),xe=n(169),Oe=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},actions:{backgroundColor:e.palette.background.paper,"& svg":{margin:e.spacing(1.5)},"& svg:hover":{cursor:"pointer"},"& hr":{margin:e.spacing(0,.5)}},header:{paddingBottom:5}}})),ge=function(e){var t=e.name,n=e.grade,a=e.author,o=e.cancel,c=Oe();return Object(r.jsx)("div",{className:c.header,children:Object(r.jsxs)(xe.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",children:[Object(r.jsxs)(xe.a,{item:!0,children:[Object(r.jsx)(C.a,{variant:"h5",component:"h2",children:"".concat(t," ").concat(be(n))}),Object(r.jsx)(C.a,{color:"textSecondary",children:"by ".concat(a)})]}),Object(r.jsx)(xe.a,{item:!0,children:Object(r.jsx)(k.a,{"aria-label":"back",onClick:o,children:Object(r.jsx)(E.a,{})})})]})})},ve=function(e,t){return e.scopes.indexOf(B)>-1||e.scopes.indexOf(H)>-1&&e.name===t},we=function(e){var t=e.problem,n=t.author,o=t.holds,c=t.uuid,i=t.name,l=t.grade,s=e.deleteProblem,d=e.cancel,u=Oe(),b=Object(a.useContext)(R);return Object(r.jsx)("div",{className:u.root,children:Object(r.jsxs)("div",{children:[Object(r.jsx)(ge,{name:i,grade:l,author:n,cancel:d}),Object(r.jsx)(ae,{holds:o}),ve(b,n)&&Object(r.jsx)(xe.a,{container:!0,alignItems:"center",direction:"row",justify:"flex-end",className:u.actions,children:Object(r.jsx)(pe.a,{"aria-label":"delete",onClick:function(){s(c),d()}})})]})})},ye=n(175),Ce=n(170),ke=n(87),Pe=n.n(ke),Ne=Object(x.a)((function(e){return{appBar:{top:"auto",bottom:0,left:"auto",right:0,position:"fixed",width:"100%",display:"flex",zIndex:1100,boxSizing:"border-box",flexShrink:0,flexDirection:"column"},grow:{flexGrow:1},fabButton:{zIndex:1,top:-15,left:0,right:0,margin:"0 auto"}}})),Se=function(e){var t=e.onCreate,n=Ne();return Object(r.jsx)("div",{color:"primary",className:n.appBar,children:Object(r.jsx)(Ce.a,{color:"secondary","aria-label":"add",className:n.fabButton,onClick:t,children:Object(r.jsx)(Pe.a,{})})})},Le=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},card:{position:"relative",marginBottom:"50px",display:"inline-block",backgroundColor:"black","& div:hover":{cursor:"pointer"}},overlay:{position:"absolute",bottom:"0",left:"0",width:"100%",color:"white",backgroundColor:"black",opacity:.6},description:{padding:"10px 20px 10px 20px"}}})),Ie=function(e){var t=e.problems,n=e.openProblem,o=e.addProblem,c=e.filters,i=void 0===c?{name:null,grade:null,author:null}:c,l=Le(),s=Object(a.useContext)(R);return 0===t.length?Object(r.jsx)("div",{className:l.root,children:"No problems created yet"}):Object(r.jsxs)("div",{className:l.root,children:[t.filter((function(e){var t=e.name;return!i.name||t.toLowerCase().indexOf(i.name.toLowerCase())>-1})).filter((function(e){var t=e.author;return!i.author||t.toLowerCase().indexOf(i.author.toLowerCase())>-1})).filter((function(e){var t=e.grade;return!i.grade||t<=i.grade.lte&&t>=i.grade.gte})).map((function(e){var t=e.uuid,a=e.holds,o=e.name,c=e.grade,i=e.author;return Object(r.jsx)("div",{className:l.card,onClick:function(){return n(t)},children:Object(r.jsxs)("div",{children:[Object(r.jsx)(ae,{holds:a}),Object(r.jsx)("div",{className:l.overlay,children:Object(r.jsx)("div",{className:l.description,children:Object(r.jsx)(ye.a,{display:"flex",p:1,children:Object(r.jsxs)(ye.a,{p:1,flexGrow:1,children:[Object(r.jsx)(C.a,{variant:"h5",children:"".concat(o," ").concat(be(c))}),Object(r.jsx)(C.a,{variant:"body1",children:"by: ".concat(i)})]})})})})]})},o)})),s.scopes.indexOf(I)>-1&&Object(r.jsx)(Se,{onCreate:o})]})},Be=Object(x.a)((function(e){return{root:{}}})),He=function(e){var t=e.problems,n=e.wall.holds,a=e.createProblem,c=e.deleteProblem,i=Be(),s=o.a.useState("list"),d=Object(l.a)(s,2),u=d[0],b=d[1],j=o.a.useState(""),h=Object(l.a)(j,2),m=h[0],f=h[1];return Object(r.jsxs)("div",{className:i.root,children:["problem"===u&&Object(r.jsx)(we,{problem:t.filter((function(e){return e.uuid===m}))[0],deleteProblem:c,cancel:function(){return b("list")}}),"create"===u&&Object(r.jsx)(me,{holds:n,createProblem:function(e){return a(e)&&b("list")},cancel:function(){return b("list")}}),"list"===u&&Object(r.jsx)(Ie,{problems:t,openProblem:function(e){return f(e)||b("problem")},addProblem:function(){return b("create")}})]})},Re=Object(x.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},toolbar:e.mixins.toolbar,content:{flexGrow:1},loading:{display:"flex",justifyContent:"center",backgroundColor:e.palette.background.paper,marginTop:"50%",marginBottom:"50%"}}})),We=function(){var e=Re();return Object(r.jsx)("div",{className:e.loading,children:Object(r.jsx)(O.a,{})})},Me=function(e){var t=e.problems,n=e.walls,a=e.createProblem,o=e.deleteProblem,c=e.loading,i=e.onLoginChange,l=Re(),s=n[0];return Object(r.jsxs)("div",{className:l.root,children:[Object(r.jsx)(p.a,{}),Object(r.jsxs)("main",{className:l.content,children:[Object(r.jsx)(Q,{walls:n,onLoginChange:i}),Object(r.jsx)(g.a,{maxWidth:"sm",children:c?Object(r.jsx)(We,{}):Object(r.jsx)(He,{createProblem:a,deleteProblem:o,problems:t.filter((function(e){return e.wallUuid===s.uuid})),wall:s})})]})]})},Te=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={loading:!0,walls:[],problems:[]},r.createProblem=r.createProblem.bind(Object(j.a)(r)),r.deleteProblem=r.deleteProblem.bind(Object(j.a)(r)),r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;return fetch("".concat(f,"/problems")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(t){return fetch("".concat(f,"/walls")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(n){return e.setState({problems:t,walls:n,loading:!1})}))}))}},{key:"createProblem",value:function(e){var t=this;return function(e){return fetch("".concat(f,"/problems"),{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(e){return t.setState({problems:[e].concat(Object(d.a)(t.state.problems))})}))}},{key:"deleteProblem",value:function(e){var t=this,n=this.state.problems;return function(e){return fetch("".concat(f,"/problems/").concat(e),{method:"DELETE"}).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(){return t.setState({problems:n.filter((function(t){return t.uuid!==e}))})}))}},{key:"render",value:function(){return Object(r.jsx)(Me,Object(s.a)(Object(s.a)({},this.props),{},{createProblem:this.createProblem,deleteProblem:this.deleteProblem,problems:this.state.problems,walls:this.state.walls,loading:this.state.loading}))}}]),n}(o.a.PureComponent),Ee=n(90),Fe=n(174),Ge=n(88),Ae=n.n(Ge),De=n(89),ze=n.n(De),Je=Object(Ee.a)({palette:{primary:Ae.a,secondary:ze.a}}),Ue=function(){var e=o.a.useState({signedIn:!1,scopes:[L]}),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(r.jsx)(R.Provider,{value:n,children:Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(Fe.a,{theme:Je,children:Object(r.jsx)(Te,{onLoginChange:a})})})})};i.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(Ue,{})}),document.getElementById("root"))}},[[115,1,2]]]);
//# sourceMappingURL=main.9aaa2e29.chunk.js.map