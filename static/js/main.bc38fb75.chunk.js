(this["webpackJsonphome-wall"]=this["webpackJsonphome-wall"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(0),o=n.n(r),c=n(10),s=n.n(c),i=(n(101),n(102),n(41)),l=n(26),d=n(27),h=n(15),u=n(33),b=n(32),j="https://europe-west3-homewall-301021.cloudfunctions.net/HomeWall",m=n(42),p=n(62),f=n.p+"static/media/wall.ecca603c.jpg",x=function(e,t){return e.x===t.x&&e.y===t.y},O=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!x(e[n],t[n]))return!1;return!0},v=window.matchMedia&&window.matchMedia("screen and (max-width: 900px)").matches?2*window.devicePixelRatio:window.devicePixelRatio,g=window.matchMedia?window.matchMedia("screen and (max-width: 600px)").matches?2.1:window.matchMedia("screen and (max-width: 900px)").matches?1.5:1:1,y=function(e){return e/g*v},w=function(e,t){e.forEach((function(e){t.beginPath();var n=e[0],a=n.x,r=n.y;t.moveTo(y(a),y(r)),e.forEach((function(e){var n=e.x,a=e.y;return t.lineTo(y(n),y(a))})),t.lineTo(y(a),y(r)),t.stroke(),t.closePath()}))},k=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).canvasRef=o.a.createRef(),a.state={img:new Image},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this.state.img,t=this.props.holds,n=this.canvasRef.current,a=n.getContext("2d");e.src=f,this.setState({img:e}),e.onload=function(){var r=Math.floor(e.height/(e.width/600)/g),o=Math.floor(600/g);n.width=o*v,n.height=r*v,n.style.width="".concat(o,"px"),n.style.height="".concat(r,"px"),a.drawImage(e,0,0,n.width,n.height),a.lineWidth=1*v,a.strokeStyle="#FFFFFF",w(t,a)}}},{key:"componentDidUpdate",value:function(e){var t=this.props.holds,n=e.holds,a=this.state.img;if(n!==t){var r=this.canvasRef.current,o=r.getContext("2d");!function(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(!O(e[n],t[n]))return!1;return!0}(t,n)?(o.clearRect(0,0,r.width,r.height),o.drawImage(a,0,0,r.width,r.height),w(t,o)):w(t.slice(n.length),o)}}},{key:"render",value:function(){var e=this,t=this.props.onClick;return Object(a.jsx)("canvas",{ref:this.canvasRef,onMouseDown:function(n){var a=n.clientX,r=n.clientY;if(t){var o=e.canvasRef.current.getBoundingClientRect(),c=a-o.left,s=r-o.top;t({x:c*g,y:s*g})}}})}}]),n}(o.a.PureComponent),C=n(149),P=n(151),N=n(63),H=n(153),S=n(154),B=n(80),W=n.n(B),D=n(166),M={0:"5",1:"5+",2:"6A",3:"6A+",4:"6B",5:"6B+",6:"6C",7:"6C+",8:"7A",9:"7A+",10:"7B"},E=function(e){return M[e]||e},R=Object(C.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},card:{position:"relative",marginBottom:"50px",display:"inline-block",backgroundColor:"black"},overlay:{position:"absolute",bottom:"0",left:"0",width:"100%",color:"white",backgroundColor:"black",opacity:.61},description:{padding:"10px 10px 10px 10px"},icons:{color:"white"}}})),T=function(e){var t=e.problems,n=e.deleteProblem,r=R();return 0===t.length?Object(a.jsxs)("div",{className:r.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsx)(H.a,{maxWidth:"sm",children:Object(a.jsx)("div",{className:r.root,children:"No problems created yet"})})]}):Object(a.jsxs)("div",{className:r.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsx)(H.a,{maxWidth:"sm",children:t.map((function(e){var t=e.uuid,o=e.holds,c=e.name,s=e.grade,i=e.author;return Object(a.jsxs)("div",{className:r.card,children:[Object(a.jsx)(k,{holds:o}),Object(a.jsx)("div",{className:r.overlay,children:Object(a.jsx)("div",{className:r.description,children:Object(a.jsxs)(D.a,{display:"flex",p:1,children:[Object(a.jsxs)(D.a,{p:1,flexGrow:1,children:[Object(a.jsx)(N.a,{variant:"h5",children:"".concat(c," ").concat(E(s))}),Object(a.jsx)(N.a,{variant:"body1",children:"by: ".concat(i)})]}),Object(a.jsx)(D.a,{p:1,children:Object(a.jsx)(S.a,{"aria-label":"delete",className:r.icons,onClick:function(){return n(t)},children:Object(a.jsx)(W.a,{})})})]})})})]},c)}))})]})},A=n(155),F=Object(C.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),K=function(e){var t=e.holds,n=e.handleClick,r=e.saveBoard,o=F();return Object(a.jsxs)("div",{className:o.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsxs)(H.a,{maxWidth:"sm",children:[Object(a.jsx)(k,{onClick:n,holds:t}),Object(a.jsx)(A.a,{className:o.formControl,variant:"contained",color:"primary",onClick:r,children:"Save board"})]})]})},G=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={points:[],holds:[]},a.handleClick=a.handleClick.bind(Object(h.a)(a)),a.createHold=a.createHold.bind(Object(h.a)(a)),a.saveBoard=a.saveBoard.bind(Object(h.a)(a)),a.handleKeyDown=a.handleKeyDown.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"handleKeyDown",value:function(e){var t=e.metaKey,n=e.keyCode,a=this.state.holds;t&&90===n&&a.length>0?this.setState({holds:a.slice(0,a.length-1)}):13===n&&this.createHold()}},{key:"handleClick",value:function(e){var t=e.x,n=e.y,a=this.state.points;this.setState({points:[].concat(Object(i.a)(a),[{x:t,y:n}])})}},{key:"createHold",value:function(){var e=this.state,t=e.points,n=e.holds;t.length<3||this.setState({holds:[].concat(Object(i.a)(n),[t]),points:[]})}},{key:"saveBoard",value:function(){(0,this.props.updateHolds)(this.state.holds)}},{key:"render",value:function(){return Object(a.jsx)(K,{holds:this.state.holds,handleClick:this.handleClick,saveBoard:this.saveBoard})}}]),n}(o.a.PureComponent),I=n(81),J=n.n(I),L=n(164),U=n(161),V=n(170),X=n(169),Y=n(82),q=n.n(Y),z=n(159),Q=n(115),Z=n(162),$=n(163),_=n(83),ee=n.n(_),te=n(165),ne=n(13),ae=n(171),re=n(158),oe=n(173),ce=n(167),se=n(160),ie=Object(C.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),le=function(e){var t=e.selectedHolds,n=e.clickHold,r=e.saveProblem,c=ie(),s=o.a.useState(5),i=Object(m.a)(s,2),l=i[0],d=i[1],h=o.a.useState(null),u=Object(m.a)(h,2),b=u[0],j=u[1],p=o.a.useState("Scott Williams"),f=Object(m.a)(p,2),x=f[0],O=f[1],v=t.length<3||!b||!x||!l;return Object(a.jsxs)("div",{className:c.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsxs)(H.a,{maxWidth:"sm",children:[Object(a.jsx)(k,{onClick:n,holds:t}),Object(a.jsxs)("div",{children:[Object(a.jsx)(ae.a,{className:c.formControl,label:"Problem Name",variant:"outlined",onChange:function(e){var t=e.target.value;return j(t)}}),Object(a.jsx)(ae.a,{className:c.formControl,label:"Author",defaultValue:x,variant:"outlined",onChange:function(e){var t=e.target.value;return O(t)}}),Object(a.jsxs)(re.a,{variant:"outlined",className:c.formControl,children:[Object(a.jsx)(oe.a,{children:"Grade"}),Object(a.jsx)(ce.a,{value:l,onChange:function(e){var t=e.target.value;return d(t)},label:"Grade",children:Object.keys(M).map((function(e){return Object(a.jsx)(se.a,{value:e,children:E(e)})}))})]})]}),Object(a.jsx)(A.a,{className:c.formControl,variant:"contained",color:"primary",onClick:function(){return r({name:b,grade:l,author:x,holds:t})},disabled:v,children:"Save problem"})]})]})},de=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={selectedHolds:[]},a.clickHold=a.clickHold.bind(Object(h.a)(a)),a.saveProblem=a.saveProblem.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"clickHold",value:function(e){var t=this,n=e.x,a=e.y,r=this.props.holds,o=this.state.selectedHolds;r.forEach((function(e){(function(e,t){for(var n=e.x,a=e.y,r=!1,o=0,c=t.length-1;o<t.length;c=o++){var s=t[o].x,i=t[o].y,l=t[c].x,d=t[c].y;i>a!==d>a&&n<(l-s)*(a-i)/(d-i)+s&&(r=!r)}return r})({x:n,y:a},e)&&t.setState({selectedHolds:-1===o.indexOf(e)?[].concat(Object(i.a)(o),[e]):o.filter((function(t){return!O(t,e)}))})}))}},{key:"saveProblem",value:function(e){var t=this;(0,this.props.createProblem)(e).then((function(){return t.setState({selectedHolds:[]})}))}},{key:"render",value:function(){var e=this.state.selectedHolds;return Object(a.jsx)(le,{selectedHolds:e,clickHold:this.clickHold,saveProblem:this.saveProblem})}}]),n}(o.a.PureComponent),he=240,ue=Object(C.a)((function(e){return{root:{display:"flex"},drawer:Object(p.a)({},e.breakpoints.up("sm"),{width:he,flexShrink:0}),appBar:Object(p.a)({},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(he,"px)"),marginLeft:he}),menuButton:Object(p.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:he},content:{flexGrow:1,padding:e.spacing(3)}}})),be=function(e){var t=e.page,n=e.setPage,r=ue();return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:r.toolbar}),Object(a.jsx)(U.a,{}),Object(a.jsxs)(z.a,{children:[Object(a.jsxs)(Q.a,{button:!0,onClick:function(){return n("create")},selected:"create"===t,children:[Object(a.jsx)(Z.a,{children:Object(a.jsx)(J.a,{})}),Object(a.jsx)($.a,{primary:"Create problem"})]}),Object(a.jsxs)(Q.a,{button:!0,onClick:function(){return n("list")},selected:"list"===t,children:[Object(a.jsx)(Z.a,{children:Object(a.jsx)(q.a,{})}),Object(a.jsx)($.a,{primary:"Existing problems"})]})]})]})},je=function(e){var t=e.fullWidth,n=void 0!==t&&t,r=e.handleDrawerToggle,o=ue();return Object(a.jsx)("div",{children:Object(a.jsx)(L.a,{position:"fixed",className:n?null:o.appBar,children:Object(a.jsxs)(te.a,{children:[Object(a.jsx)(S.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:r,className:o.menuButton,children:Object(a.jsx)(ee.a,{})}),Object(a.jsx)(N.a,{variant:"h6",noWrap:!0,children:"Home Wall"})]})})})},me=function(e){var t=e.problems,n=e.holds,r=e.createProblem,c=e.deleteProblem,s=e.loading,i=e.updateHolds,l=ue(),d=Object(ne.a)(),h=o.a.useState(!1),u=Object(m.a)(h,2),b=u[0],j=u[1],p=o.a.useState("list"),f=Object(m.a)(p,2),x=f[0],O=f[1],v=function(){j(!b)};return 0===n.length?Object(a.jsxs)("div",{className:l.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsx)(je,{handleDrawerToggle:v,fullWidth:!0}),Object(a.jsxs)("main",{className:l.content,children:[Object(a.jsx)("div",{className:l.toolbar}),!s&&Object(a.jsx)(G,{updateHolds:i})]})]}):Object(a.jsxs)("div",{className:l.root,children:[Object(a.jsx)(P.a,{}),Object(a.jsx)(je,{handleDrawerToggle:v}),Object(a.jsxs)("nav",{className:l.drawer,"aria-label":"mailbox folders",children:[Object(a.jsx)(X.a,{smUp:!0,implementation:"css",children:Object(a.jsx)(V.a,{variant:"temporary",anchor:"rtl"===d.direction?"right":"left",open:b,onClose:v,classes:{paper:l.drawerPaper},ModalProps:{keepMounted:!0},children:Object(a.jsx)(be,{setPage:function(e){O(e),j(!1)}})})}),Object(a.jsx)(X.a,{xsDown:!0,implementation:"css",children:Object(a.jsx)(V.a,{classes:{paper:l.drawerPaper},variant:"permanent",open:!0,children:Object(a.jsx)(be,{page:x,setPage:O})})})]}),Object(a.jsxs)("main",{className:l.content,children:[Object(a.jsx)("div",{className:l.toolbar}),"list"===x&&Object(a.jsx)(T,{problems:t,deleteProblem:c}),"create"===x&&Object(a.jsx)(de,{holds:n,createProblem:r})]})]})},pe=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loading:!0,holds:[],problems:[]},a.updateHolds=a.updateHolds.bind(Object(h.a)(a)),a.createProblem=a.createProblem.bind(Object(h.a)(a)),a.deleteProblem=a.deleteProblem.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;return fetch("".concat(j,"/problems")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(t){return fetch("".concat(j,"/holds")).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})})).then((function(n){return e.setState({problems:t,holds:n,loading:!1})}))}))}},{key:"createProblem",value:function(e){var t=this;return function(e){return fetch("".concat(j,"/problems"),{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(e){return t.setState({problems:[e].concat(Object(i.a)(t.state.problems))})}))}},{key:"deleteProblem",value:function(e){var t=this,n=this.state.problems;return function(e){return fetch("".concat(j,"/problems/").concat(e),{method:"DELETE"}).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(){return t.setState({problems:n.filter((function(t){return t.uuid!==e}))})}))}},{key:"updateHolds",value:function(e){var t=this;return function(e){return fetch("".concat(j,"/holds"),{method:"PUT",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}),(function(e){console.error({error:e})}))}(e).then((function(e){return t.setState({holds:e})}))}},{key:"render",value:function(){return Object(a.jsx)(me,{problems:this.state.problems,holds:this.state.holds,createProblem:this.createProblem,deleteProblem:this.deleteProblem,updateHolds:this.updateHolds,loading:this.state.loading})}}]),n}(o.a.PureComponent);var fe=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(pe,{})})};s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(fe,{})}),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.bc38fb75.chunk.js.map